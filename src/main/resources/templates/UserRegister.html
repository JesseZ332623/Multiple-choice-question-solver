<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用户注册</title>
</head>

<style>
    /* GitHub Dark 模式配色 */
    body {
        background-color: #161B22;
        color: #C9D1D9;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
        margin: 0;
        padding: 20px;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    /* 响应式表单容器 */
    #register_area {
        max-width: 480px;
        width: 100%;
        background-color: #1F2428;
        border-radius: 6px;
        padding: 2rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
    }

    /* 响应式媒体查询 */
    @media (max-width: 768px) {
        #register_area {
            padding: 1.5rem;
        }
    }

    h1 {
        color: #0366D6;
        text-align: center;
        margin-bottom: 1rem;
        font-size: 2rem;
    }

    label {
        display: flex;
        flex-direction: column;
        margin-bottom: 1.5rem;
    }

    input[type="text"],
    input[type="password"],
    input[type="tel"],
    input[type="email"] {
        background-color: #21262D;
        border: 1px solid #30363D;
        color: #C9D1D9;
        padding: 0.8rem;
        margin-top: 0.5rem;
        border-radius: 4px;
        font-size: 1rem;
        transition: border-color 0.3s ease;
    }

    input:focus {
        outline: none;
        border-color: #007ACC;
        box-shadow: 0 0 0 2px rgba(0, 121, 211, 0.2);
    }

    button {
        background-color: #0366D6;
        color: white;
        padding: 0.8rem 2rem;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 1rem;
        transition: all 0.3s ease;
        margin-top: 1rem;
    }

    button:hover {
        background-color: #0052cc;
    }

    /* GitHub风格的错误提示 */
    .error {
        color: #ff4b4b;
        font-size: 0.875rem;
        margin-top: 0.5rem;
    }

    /* 响应式按钮 */
    @media (max-width: 480px) {
        button {
            width: 100%;
        }
    }
</style>

<body>
    <h1>欢迎新用户</h1>

    <div id="register_area">
        <label for="user_name">
            <span>用户名</span>
            <input type="text" id="user_name" name="user_name" required>
        </label>
        <label for="password">
            <span>密码</span>
            <input type="password" id="password" name="password" required>
        </label>
        <label for="confirm_password">
            <span>确认密码</span>
            <input type="password" id="confirm_password" name="confirm_password" required>
        </label>
        <label for="full_name">
            <span>全名</span>
            <input type="text" id="full_name" name="full_name">
        </label>
        <label for="phone_number">
            <span>手机号</span>
            <input type="tel" id="phone_number" name="phone_number">
        </label>
        <label for="email">
            <span>邮箱</span>
            <input type="email" id="email" name="email" required>
        </label>
    </div>
    <div id="submit_area">
        <button type="button" onclick="doRegister()">立即注册</button>
    </div>
</body>
<script>
    async function doRegister() 
    {
        const fields = 
        {
            user_name: document.getElementById('user_name').value.trim(),
            password: document.getElementById('password').value.trim(),
            confirm_password: document.getElementById('confirm_password').value.trim(),
            full_name: document.getElementById('full_name').value.trim(),
            phone_number: document.getElementById('phone_number').value.trim(),
            email: document.getElementById('email').value.trim(),
        };

        // 必填字段验证
        const required = ['user_name', 'password', 'email'];
        let hasError = false;
        required.forEach(key => {
            if (!fields[key]) {
                alert(`字段 ${key} 不得为空，请重新填写。`);
                hasError = true;
            }
        });
        if (hasError) return;

        // 密码验证
        if (fields.password !== fields.confirm_password) {
            alert('两次输入的密码不一致，请重新输入。');
            return;
        }

        // 构建请求数据
        const data = {
            "userName": fields.user_name,
            "password": fields.password,
            "fullName": fields.full_name,
            "telephoneNumber": fields.phone_number,
            "email": fields.email
        };

        // 发送请求
        try {
            const response = await fetch('/api/user_info/register', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.message || '注册失败');
            }

            alert('注册成功！欢迎加入我们！');

            // 重置表单
            document.querySelectorAll('input').forEach(input => input.value = '');

        } catch (error) {
            alert('注册失败：' + error.message);
            console.error(error);
        }
    }
</script>

</html>